{% extends 'core/base.html' %} 

{% block title %}Processing Order #{{ order.id }}{% endblock %}

{% block content %}
    <h1 class="mb-4">ðŸ“‹ Processing Order #{{ order.id }}</h1>
    
    <div class="row">
        <div class="col-md-5">
            <div class="card shadow-sm p-4 mb-4 bg-light">
                <h5 class="card-title border-bottom pb-2">Order Summary</h5>
                <p><strong>Current Status:</strong> <span class="badge bg-warning fs-6">{{ order.status }}</span></p>
                <p><strong>Placed By:</strong> {{ order.get_customer.user.username }} ({{ customer_type }})</p>
                <p><strong>Time Placed:</strong> {{ order.order_time|date:"DATETIME_FORMAT" }}</p>
                <h4 class="mt-3">Grand Total: ${{ order.total_amount|floatformat:2 }}</h4>
            </div>

            <div class="card p-4 shadow-sm">
                <h5 class="card-title border-bottom pb-2">Update Status</h5>
                <form method="POST">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label for="status-select" class="form-label">New Status</label>
                        <select class="form-select" id="status-select" name="status" required>
                            {% for status in status_choices %}
                                <option value="{{ status }}" {% if status == order.status %}selected{% endif %}>
                                    {{ status }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">Update Order</button>
                </form>
            </div>
        </div>

        <div class="col-md-7">
            <div class="card shadow-sm p-4">
                <h5 class="card-title border-bottom pb-2">Line Items</h5>
                <ul class="list-group list-group-flush">
                    {% for detail in order_details %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>{{ detail.item.name }}</strong>
                                <small class="text-muted d-block">Qty: {{ detail.quantity }}</small>
                            </div>
                            <span>${{ detail.subtotal|floatformat:2 }}</span>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
{% endblock content %}